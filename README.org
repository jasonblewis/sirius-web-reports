* methods of running
** shotgun
   plackup -L Shotgun bin/app.psgi
** starman
   plackup -E development -s Starman bin/app.psgi
* medium scale app
  http://lists.preshweb.co.uk/pipermail/dancer-users/2015-October/005237.html
  https://github.com/wyoung/advent-calendar/tree/master/danceradvent/public/articles/2015

* to launch for production
pkill fcgi && DANCER_ENVIRONMENT=production plackup -D -E deployment -s FCGI --listen  /var/run/reports/reports.sock /home/reports/Reports/bin/app.psgi
* to launch for development
DANCER_ENVIRONMENT=development plackup -L Shotgun bin/app.psgi
* authentication via config file
  generate hashed passwords with /usr/sbin/slappasswd
* to test the app
#+BEGIN_SRC 
DANCER_ENVIRONMENT=test prove -l t/002_index_route.t
#+END_SRC
* curl ajax
** to login with curl:
#+BEGIN_SRC bash
curl --cookie-jar ~/.curl-cookies --data 'username=test;password=test' localhost:5000/login

#+END_SRC
**  to do an ajax request with curl and cookies:
#+BEGIN_SRC bash
curl -b ~/.curl-cookies -H 'X-Requested-With: XMLHttpRequest' -d"message=hello" localhost:5000/time
#+END_SRC
  
* deployment steps
#+BEGIN_SRC bash
# get the latest version
git pull
# install any new dependencies
cpanm --installdeps .
# run tests
DANCER_ENVIRONMENT=test prove -l t/002_index_route.t
# kill old instance
pkill fcgi
# start new instance
DANCER_ENVIRONMENT=production plackup -D -E deployment -s FCGI --listen  /var/run/reports/reports.sock /home/reports/Reports/bin/app.psgi
#+END_SRC
